export const metadata = {
  title: 'Amount Input',
  description: 'Let users enter a USD amount to pay with optional token selection.',
}

export const sections = [
  { title: 'Usage', id: 'usage' },
  { title: 'Configuration', id: 'configuration' },
  // onramp: { title: 'Onramp (Transak)', id: 'onramp' },
]

# Amount Input

The Amount Input component lets users enter a custom USD amount and pay, optionally choosing a token from a dropdown. {{ className: 'lead' }}

## Usage

<CodeGroup title="Amount Input">

```tsx {{ title: 'Next.js (React wrapper)' }}
'use client'
import { IcpayAmountInput, IcpaySuccess } from '@ic-pay/icpay-widget/react'

export default function Page() {
  const config = {
    publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
    defaultAmountUsd: 20,
    minUsd: 1,
    stepUsd: 1,
    defaultSymbol: 'ICP',
    showLedgerDropdown: 'dropdown',
    cryptoOptions: [
      { symbol: 'ICP', label: 'ICP' },
      { symbol: 'ckUSDC', label: 'USDC' },
    ],
    progressBar: { enabled: true, mode: 'modal' },
  }
  return (
    <IcpayAmountInput
      config={config}
      onSuccess={(detail: IcpaySuccess) => console.log('Paid', detail)}
    />
  )
}
```

```tsx {{ title: 'Next.js' }}
'use client'
import { useEffect, useRef } from 'react'
import '@ic-pay/icpay-widget'

export default function Page() {
  const ref = useRef<any>(null)
  useEffect(() => {
    if (!ref.current) return
    ref.current.config = {
      publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
      defaultAmountUsd: 20,
      minUsd: 1,
      stepUsd: 1,
      defaultSymbol: 'ICP',
      // Show dropdown to let users pick ICP or USDC
      showLedgerDropdown: true,
      cryptoOptions: [
        { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
        { symbol: 'ckUSDC', label: 'USDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
      ],
      // Modal progress bar matches other components
      progressBar: { enabled: true, mode: 'modal' },
    }
  }, [])
  return <icpay-amount-input ref={ref as any} />
}

```vue {{ title: 'Vue.js' }}
<script setup lang="ts">
import { onMounted, ref } from 'vue'
import '@ic-pay/icpay-widget'
const el = ref<any>(null)
onMounted(() => {
  if (!el.value) return
  el.value.config = {
    publishableKey: import.meta.env.VITE_ICPAY_PK,
    defaultAmountUsd: 20,
    minUsd: 1,
    stepUsd: 1,
    defaultSymbol: 'ICP',
    showLedgerDropdown: true,
    cryptoOptions: [
      { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
      { symbol: 'ckUSDC', label: 'USDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
    ],
    progressBar: { enabled: true, mode: 'modal' },
  }
})
</script>
<template>
  <icpay-amount-input ref="el" />
</template>

```ts {{ title: 'Angular' }}
import { Component, ElementRef, ViewChild, AfterViewInit } from '@angular/core'
import '@ic-pay/icpay-widget'
@Component({ selector: 'app-root', template: `<icpay-amount-input #el></icpay-amount-input>` })
export class AppComponent implements AfterViewInit {
  @ViewChild('el', { static: true }) el!: ElementRef<any>
  ngAfterViewInit() {
    this.el.nativeElement.config = {
      publishableKey: (window as any).env?.ICPAY_PK || 'pk_test_xxx',
      defaultAmountUsd: 20,
      minUsd: 1,
      stepUsd: 1,
      defaultSymbol: 'ICP',
      showLedgerDropdown: true,
      cryptoOptions: [
        { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
        { symbol: 'ckUSDC', label: 'USDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
      ],
      progressBar: { enabled: true, mode: 'modal' },
    }
  }
}

```html {{ title: 'No framework' }}
<script type="module">import '@ic-pay/icpay-widget'</script>
<icpay-amount-input id="el"></icpay-amount-input>
<script>
  el.config = {
    publishableKey: 'pk_test_xxx',
    defaultAmountUsd: 20,
    minUsd: 1,
    stepUsd: 1,
    defaultSymbol: 'ICP',
    showLedgerDropdown: true,
    cryptoOptions: [
      { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
      { symbol: 'ckUSDC', label: 'USDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
    ],
    progressBar: { enabled: true, mode: 'modal' },
  }
</script>

```

</CodeGroup>

## Configuration

- `defaultAmountUsd?: number`
- `placeholder?: string`
- `minUsd?: number`, `maxUsd?: number`, `stepUsd?: number`
- `cryptoOptions?: { symbol: string; label: string; canisterId?: string }[]`
- Token selector:
  - Per-component legacy: `showLedgerDropdown?: boolean` (default: false)
  - Global (recommended): `showLedgerDropdown?: 'buttons' | 'dropdown' | 'none'`
- `defaultSymbol?: string` (e.g., `'ICP'`)
- `buttonLabel?: string`
- `progressBar?: { enabled?: boolean; mode?: 'modal' | 'horizontal' | 'vertical' | 'inline' }`

Notes:
- With the global `showLedgerDropdown` string:
  - `'buttons'` shows selector chips when multiple tokens are available; hides selector if only one.
  - `'dropdown'` always shows a dropdown.
  - `'none'` hides the selector and uses `defaultSymbol`.
- For non-modal progress modes, the bar appears only during processing.

{/*
## Onramp (Transak)

Add card onramp by configuring `onramp`. The widget will create an onramp intent (`onramp_ic`), open Transak, close on `TRANSAK_ORDER_SUCCESSFUL`, then notify ICPay until completion.

- `onramp.enabled?: boolean` — enable/disable card payments in the wallet modal (default: enabled)

```tsx
'use client'
import { useEffect, useRef } from 'react'
import '@ic-pay/icpay-widget'

export default function Page() {
  const ref = useRef<any>(null)
  useEffect(() => {
    if (!ref.current) return
    ref.current.config = {
      publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
      defaultAmountUsd: 20,
      showLedgerDropdown: true,
      onramp: {
        environment: 'STAGING',
        apiKey: process.env.NEXT_PUBLIC_TRANSAK_PK,
        creditCardLabel: 'Pay with credit card',
        enabled: true,
      },
      progressBar: { enabled: true, mode: 'modal' },
    }
  }, [])
  return <icpay-amount-input ref={ref as any} />
}
```

During onramp, the progress bar updates the first step label to “Transak Started” with tooltip “Awaiting Transak information”.
*/}


