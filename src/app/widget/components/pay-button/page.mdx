export const metadata = {
  title: 'Pay Button',
  description: 'Simple checkout button for fixed USD payments with optional ledger dropdown.',
}

export const sections = [
  { title: 'Usage', id: 'usage' },
  { title: 'Configuration', id: 'configuration' },
  // onramp: { title: 'Onramp (Transak)', id: 'onramp' },
]

# Pay Button

The Pay Button component renders a compact, single-action checkout button for a fixed USD amount. Optionally filter available tokens via `tokenShortcodes`. {{ className: 'lead' }}

## Usage

<CodeGroup title="Pay Button">

```tsx {{ title: 'Next.js (React wrapper)' }}
'use client'
import { IcpayPayButton, IcpaySuccess } from '@ic-pay/icpay-widget/react'

export default function Page() {
  const config = {
    publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
    amountUsd: 49.99,
    // Optional: constrain wallets/tokens shown
    // chainTypes: ['ic','evm'],
    // chainShortcodes: ['ic','base'],
    // tokenShortcodes: ['ic_icp','ic_ckusdc','base_eth'],
    // progressBar: { enabled: true },
  }
  return (
    <IcpayPayButton
      config={config}
      onSuccess={(detail: IcpaySuccess) => console.log('Paid', detail)}
    />
  )
}
```

```tsx {{ title: 'Next.js' }}
'use client'
import { useEffect, useRef } from 'react'
import '@ic-pay/icpay-widget'

export default function Page() {
  const ref = useRef<any>(null)
  useEffect(() => {
    if (!ref.current) return
    ref.current.config = {
      publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
      amountUsd: 49.99,
      // Optional
      // progressBar: { enabled: true },
    }
  }, [])
  return <icpay-pay-button ref={ref as any} />
}

```vue {{ title: 'Vue.js' }}
<script setup lang="ts">
import { onMounted, ref } from 'vue'
import '@ic-pay/icpay-widget'
const el = ref<any>(null)
onMounted(() => {
  if (!el.value) return
  el.value.config = {
    publishableKey: import.meta.env.VITE_ICPAY_PK,
    amountUsd: 49.99,
    // Optional
    // progressBar: { enabled: true },
  }
})
</script>
<template>
  <icpay-pay-button ref="el" />
</template>

```ts {{ title: 'Angular' }}
import { Component, ElementRef, ViewChild, AfterViewInit } from '@angular/core'
import '@ic-pay/icpay-widget'
@Component({ selector: 'app-root', template: `<icpay-pay-button #el></icpay-pay-button>` })
export class AppComponent implements AfterViewInit {
  @ViewChild('el', { static: true }) el!: ElementRef<any>
  ngAfterViewInit() {
    this.el.nativeElement.config = {
      publishableKey: (window as any).env?.ICPAY_PK || 'pk_test_xxx',
      amountUsd: 49.99,
      // Optional
      // progressBar: { enabled: true },
    }
  }
}

```html {{ title: 'No framework' }}
<script type="module">import '@ic-pay/icpay-widget'</script>
<icpay-pay-button id="el"></icpay-pay-button>
<script>
  el.config = {
    publishableKey: 'pk_test_xxx',
    amountUsd: 49.99,
    // Optional
    // progressBar: { enabled: true },
  }
</script>

```

</CodeGroup>

## Configuration

- `amountUsd?: number`
- `buttonLabel?: string` (used if `amountUsd` not set)
- `progressBar?: { enabled?: boolean }`
- Common options: `tokenShortcodes?: string[]`, `chainShortcodes?: string[]`, `chainTypes?: Array<'ic' | 'evm'>`, `theme?`, `useOwnWallet?`, `plugNPlay?`, `debug?`, `disablePaymentButton?`, `disableAfterSuccess?`

{/* onramp-start */}
## Onramp (Transak)

Enable card onramp from the wallet selector by configuring `onramp` and handle the success event. The component will:

- Create an onramp intent via the SDK (`createPaymentUsd` with `onrampPayment: true`).
- Open Transak using the returned `sessionId`.
- Close the Transak modal on `TRANSAK_ORDER_SUCCESSFUL` and start notifying ICPay until completion.

```tsx
'use client'
import { useEffect, useRef } from 'react'
import '@ic-pay/icpay-widget'

export default function Page() {
  const ref = useRef<any>(null)
  useEffect(() => {
    if (!ref.current) return
    ref.current.config = {
      publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
      amountUsd: 49.99,
      onramp: {
        environment: 'STAGING',
        apiKey: process.env.NEXT_PUBLIC_TRANSAK_PK,
        creditCardLabel: 'Pay with credit card',
        enabled: true,
      },
      progressBar: { enabled: true },
    }
  }, [])
  return <icpay-pay-button ref={ref as any} />
}
```

The progress bar updates “wallet” to “Transak Started – Awaiting Transak information” during onramp.
{/* onramp-end */}


