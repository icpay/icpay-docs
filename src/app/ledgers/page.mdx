export const metadata = {
  title: 'Ledgers',
  description:
    'Supported ledgers, canister IDs, symbols, price data, and how to use them via SDK and Widget.',
}

export const sections = [
  { title: 'Overview', id: 'overview' },
  { title: 'Data model', id: 'data-model' },
  { title: 'Using with SDK', id: 'using-with-sdk' },
  { title: 'Using with Widget', id: 'using-with-widget' },
]

# Ledgers

ICPay supports verified ICRC ledgers (including ICP). You can fetch the list, get prices, and resolve canister IDs by symbol. {{ className: 'lead' }}

## Overview

- Each ledger provides `id`, `name`, `symbol`, `family`, `canisterId`, `decimals`, `fee`, `verified`, and optional price data.
- Prices are available when configured; USD conversions are supported via SDK helpers.

## Data model

Selected fields exposed by the SDK:

```ts
type LedgerPublic = {
  id: string
  name: string
  symbol: string
  family: string
  canisterId: string
  decimals: number
  logoUrl: string | null
  verified: boolean
  fee: string | null
  currentPrice: number | null
  lastPriceUpdate: string | null
}
```

Detailed info:

```ts
type SdkLedger = {
  id: string
  name: string
  symbol: string
  family: string
  canisterId: string
  decimals: number
  verified: boolean
  fee: string | null
  network: 'mainnet' | 'testnet'
  description: string | null
  lastBlockIndex: string | null
  coingeckoId: string | null
  currentPrice: number | null
  lastPriceUpdate: string | null
}
```

### Family grouping

The `family` field groups the same token across chains and standards (for example, USDC on EVM, ICP, or Solana). Use it to present a single token choice to users and then offer only the networks where that family has a variant. If only one family is configured, you can skip token selection and show network options directly.

## Using with SDK

```ts
import { Icpay } from '@ic-pay/icpay-sdk'
const icpay = new Icpay({ publishableKey: 'pk_test_xxx' })

const list = await icpay.getVerifiedLedgers()
const idBySymbol = await icpay.getLedgerCanisterIdBySymbol('ICP')
const info = await icpay.getLedgerInfo(idBySymbol)
const withPrices = await icpay.getAllLedgersWithPrices()

// Convert 10 USD to token amount for a ledger
const calc = await icpay.calculateTokenAmountFromUSD({ usdAmount: 10, ledgerSymbol: 'ICP' })
```

## Using with Widget

You can let the widget fetch verified ledgers automatically or supply `cryptoOptions` yourself.

<CodeGroup title="Widget examples">

```tsx {{ title: 'Next.js' }}
'use client'
import { useEffect, useRef } from 'react'
import '@ic-pay/icpay-widget'
export default function Page() {
  const ref = useRef<any>(null)
  useEffect(() => {
    if (!ref.current) return
    ref.current.config = {
      publishableKey: process.env.NEXT_PUBLIC_ICPAY_PK,
      amountsUsd: [1,5,10],
      cryptoOptions: [
        { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
        { symbol: 'ckUSDC', label: 'ckUSDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
      ],
    }
  }, [])
  return <icpay-tip-jar ref={ref as any} />
}
```

```vue {{ title: 'Vue.js' }}
<script setup lang="ts">
import { onMounted, ref } from 'vue'
import '@ic-pay/icpay-widget'
const el = ref<any>(null)
onMounted(() => {
  if (!el.value) return
  el.value.config = {
    publishableKey: import.meta.env.VITE_ICPAY_PK,
    amountsUsd: [1,5,10],
    cryptoOptions: [
      { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
      { symbol: 'ckUSDC', label: 'ckUSDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
    ],
  }
})
</script>
<template>
  <icpay-tip-jar ref="el" />
</template>
```

```ts {{ title: 'Angular' }}
import { Component, ElementRef, ViewChild, AfterViewInit } from '@angular/core'
import '@ic-pay/icpay-widget'
@Component({ selector: 'app-root', template: `<icpay-tip-jar #el></icpay-tip-jar>` })
export class AppComponent implements AfterViewInit {
  @ViewChild('el', { static: true }) el!: ElementRef<any>
  ngAfterViewInit() {
    this.el.nativeElement.config = {
      publishableKey: (window as any).env?.ICPAY_PK || 'pk_test_xxx',
      amountsUsd: [1,5,10],
      cryptoOptions: [
        { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
        { symbol: 'ckUSDC', label: 'ckUSDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
      ],
    }
  }
}
```

```html {{ title: 'No framework' }}
<script type="module">import '@ic-pay/icpay-widget'</script>
<icpay-tip-jar id="el"></icpay-tip-jar>
<script>
  el.config = {
    publishableKey: 'pk_test_xxx',
    amountsUsd: [1,5,10],
    cryptoOptions: [
      { symbol: 'ICP', label: 'ICP', canisterId: 'ryjl3-tyaaa-aaaaa-aaaba-cai' },
      { symbol: 'ckUSDC', label: 'ckUSDC', canisterId: 'xevnm-gaaaa-aaaar-qafnq-cai' },
    ],
  }
</script>
```

</CodeGroup>

<div className="not-prose">
  <Button href="/sdk" variant="text" arrow="right">
    <>Use ledgers in the SDK</>
  </Button>
</div>


